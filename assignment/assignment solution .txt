create warehouse demowarehouse;
create database demodatabase;
use demodatabase;

show databases;

create or replace table sales_data_final(
order_id varchar(20) primary key not null,
order_date varchar(20),
ship_date	varchar(20),
ship_mode	varchar(20),
customer_name	varchar(30),
segment	varchar(20),
state	varchar(50),
country varchar(50),
market	varchar(20),
region  varchar(20),
product_id	varchar(50),
category varchar(20),
sub_category varchar(20),
product_name  varchar(150),
sales 	int,
quantity	int,
discount  float,
profit  float,
shipping_cost float,
order_priority varchar(20),
year  int

);

describe table sales_data_final;
select * from sales_data_final;

/*1 .SET PRIMARY KEY.

2. CHECK THE ORDER DATE AND SHIP DATE TYPE AND THINK IN WHICH DATA TYPE YOU HAVE TO CHANGE.

3. EXTACT THE LAST NUMBER AFTER THE - AND CREATE OTHER COLUMN AND UPDATE IT.

4.  FLAG ,IF DISCOUNT IS GREATER THEN 0 THEN  YES ELSE FALSE AND PUT IT IN NEW COLUMN FRO EVERY ORDER ID.

5.  FIND OUT THE FINAL PROFIT AND PUT IT IN COLUMN FOR EVERY ORDER ID.

6.  FIND OUT HOW MUCH DAYS TAKEN FOR EACH ORDER TO PROCESS FOR THE SHIPMENT FOR EVERY ORDER ID.

7 . FLAG THE PROCESS DAY AS BY RATING IF IT TAKES LESS OR EQUAL 3  DAYS MAKE 5,LESS OR EQUAL THAN 6 DAYS BUT MORE THAN 3 MAKE 4,LESS THAN 10 BUT MORE THAN 6 MAKE 3,MORE THAN 10 MAKE IT 2 FOR EVERY ORDER ID.
*/

----2

create or replace table sales_data_final2(
order_id varchar(20) primary key not null,
order_date date,
ship_date	date,
ship_mode	varchar(20),
customer_name	varchar(30),
segment	varchar(20),
state	varchar(50),
country varchar(50),
market	varchar(20),
region  varchar(20),
product_id	varchar(50),
category varchar(20),
sub_category varchar(20),
product_name  varchar(150),
sales 	int,
quantity	int,
discount  float,
profit  float,
shipping_cost float,
order_priority varchar(20),
year  int

);

---3
select * from sales_data_final;
select distinct order_id from sales_data_final;

alter table sales_data_final
add column order_id_new varchar(20);

update sales_data_final
set order_id_new 

---4

select * ,
case
when discount > 0 then 'yes'
else 'no'
end as flag
from sales_data_final;

---6

select datediff(day,ship_date,order_date) from sales_data_final;

